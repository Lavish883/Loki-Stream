<!DOCTYPE html>
<html>
<head>
  <title>Watching Anime</title>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://vjs.zencdn.net/7.10.2/video-js.css">
  <link rel="stylesheet" href="https://7ds7.github.io/videojs-vjsdownload/dist/videojs-vjsdownload.css">
  <script src="https://cdn.jsdelivr.net/npm/video.js@7.10.2/dist/video.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-hls-quality-selector@1.1.1/dist/videojs-hls-quality-selector.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-contrib-quality-levels@2.0.6/dist/videojs-contrib-quality-levels.js"></script>
  <script src="https://7ds7.github.io/videojs-vjsdownload/dist/videojs-vjsdownload.js"></script>
  <link rel="stylesheet" href="https://gogoanime.vc/css/style.css?v=8.3">
</head>
<body onresize="resizeBody()" style="overflow:hidden;">
  <script>
    setTimeout (function() {
        var videoToPlay = window.location.href;
        var videoToPlay2 = videoToPlay.split(window.location.origin + window.location.pathname)
        var videoToPlay3 = videoToPlay.split("?play=")
        function resizeBody() {
            document.body.style.width = window.innerWidth + "px";
            document.body.style.height = window.innerHeight + "px";
        }
            // Video JS.css
            var style = document.createElement('link');
            style.setAttribute("rel", "stylesheet");
            style.setAttribute("href", "https://vjs.zencdn.net/7.10.2/video-js.css");
            // Video JS
            var script = document.createElement('script');
            script.setAttribute("src", "https://kit.fontawesome.com/9c2fbbf0d7.js");
            // Video Downloader Style
            var style_2 = document.createElement('link');
            style_2.setAttribute("href", "https://7ds7.github.io/videojs-vjsdownload/dist/videojs-vjsdownload.css")
            style_2.setAttribute("rel", "stylesheet")
            // HLS Cobtrib Selector JS
            var script_3 = document.createElement('script');
            script_3.setAttribute("src", "https://cdn.jsdelivr.net/npm/videojs-contrib-quality-levels@2.0.6/dist/videojs-contrib-quality-levels.js")
            var video = document.createElement('VIDEO')
            video.style.width = "100%";
            video.style.height = "100%";
            video.setAttribute("controls", "true");
            video.setAttribute("class", "video-js")
            video.setAttribute("data-setup", `{"poster": ""}`);
            video.setAttribute("preload", "auto");
            video.setAttribute("autoplay", "true");
            video.setAttribute("id", "vid1");
            document.body.appendChild(script);
            document.body.appendChild(video);
            document.head.appendChild(style);
            document.head.appendChild(style_2);
        if (videoToPlay3[1].includes(".mp4")) {
            var source = document.createElement('source');
            source.setAttribute('src', videoToPlay3[1]);
            video.appendChild(source);
            var player = videojs('vid1', {
                controls: true,
                plugins: {
                    vjsdownload: {
                        beforeElement: 'playbackRateMenuButton', // default fullscreenMenuToggle
                        textControl: 'Download video', // default "Download video"
                        name: 'downloadButton' // default "downloadButton"
                    },
                }
            }, function () {

            });
        } else {
            console.log('hls');
            var source = document.createElement('source');
            var z = "https://lowkeyeffort.herokuapp.com/" + videoToPlay3[1];
            console.log(z);
            source.setAttribute('src', z);
            video.appendChild(source);
            var player = videojs('vid1', {
                controls: true,
                plugins: {
                    hlsQualitySelector: {
                        displayCurrentQuality: true
                    }
                }
            }, function () {
                let qualityLevels = player.qualityLevels();

                // disable quality levels with less than 720 horizontal lines of resolution when added
                // to the list.
                qualityLevels.on('addqualitylevel', function (event) {
                    let qualityLevel = event.qualityLevel;

                    if (qualityLevel.height >= 720) {
                        qualityLevel.enabled = true;
                    } else {
                        qualityLevel.enabled = false;
                    }
                });

                // example function that will toggle quality levels between SD and HD, defining and HD
                // quality as having 720 horizontal lines of resolution or more
                let toggleQuality = (function () {
                    let enable720 = true;

                    return function () {
                        for (var i = 0; i < qualityLevels.length; i++) {
                            let qualityLevel = qualityLevels[i];
                            if (qualityLevel.height >= 720) {
                                qualityLevel.enabled = enable720;
                            } else {
                                qualityLevel.enabled = !enable720;
                            }
                        }
                        enable720 = !enable720;
                    };
                })();

                let currentSelectedQualityLevelIndex = qualityLevels.selectedIndex; // -1 if no level selected

                // Listen to change events for when the player selects a new quality level
                qualityLevels.on('change', function () {
                    console.log('Quality Level changed!');
                });
                //this.play();
            })
        }
  </script>
</body>
</html>
